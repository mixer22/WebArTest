<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Ветряная батарейка</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #0f172a;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
  color: #e5e7eb;
}

h1 {
  margin-bottom: 20px;
  text-align: center;
}

/* Контейнер батарейки */
.battery-container {
  width: 80px;
  height: 160px;
  border: 4px solid #94a3b8;
  border-radius: 12px;
  position: relative;
  overflow: hidden;
  background: #1e293b;
  margin-bottom: 30px;
}

.battery-fill {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 0%;
  background: linear-gradient(180deg, #34d399, #059669);
  transition: height 0.3s ease;
  border-radius: 6px 6px 0 0;
  box-shadow: 0 0 10px #34d39955 inset;
}

.battery-tip {
  position: absolute;
  top: -10px;
  left: 25%;
  width: 50%;
  height: 10px;
  background: #94a3b8;
  border-radius: 4px 4px 0 0;
}

/* Ветряная мельница */
.windmill {
  width: 120px;
  height: 120px;
  margin-bottom: 20px;
  position: relative;
  touch-action: none; /* чтобы тач работал */
}

.windmill svg {
  width: 100%;
  height: 100%;
  transform-origin: center center;
  user-select: none;
}

/* Слово-ответ */
.answer {
  margin-top: 20px;
  font-size: 24px;
  font-weight: bold;
  color: #34d399;
  opacity: 0;
  transition: opacity 0.5s;
}
.answer.show {
  opacity: 1;
}
</style>
</head>

<body>

<h1>⚡ Заряди батарейку!</h1>

<div class="windmill" id="windmill">
  <!-- рисуем настоящие лопасти через SVG -->
  <svg viewBox="0 0 100 100">
    <g id="blades">
      <rect x="48" y="10" width="4" height="40" rx="2" fill="#e5e7eb"/>
      <rect x="48" y="50" width="4" height="40" rx="2" fill="#e5e7eb" transform="rotate(90 50 50)"/>
      <rect x="48" y="50" width="4" height="40" rx="2" fill="#e5e7eb" transform="rotate(180 50 50)"/>
      <rect x="48" y="50" width="4" height="40" rx="2" fill="#e5e7eb" transform="rotate(270 50 50)"/>
      <circle cx="50" cy="50" r="6" fill="#94a3b8"/>
    </g>
  </svg>
</div>

<div class="battery-container">
  <div class="battery-fill" id="batteryFill"></div>
  <div class="battery-tip"></div>
</div>

<div class="answer" id="answer">ЭНЕРГИЯ</div>

<script>
const fill = document.getElementById("batteryFill");
const answer = document.getElementById("answer");
const windmill = document.getElementById("windmill");
const blades = document.getElementById("blades");

let charge = 0;
let rotation = 0;
let lastAngle = null;

// функция для увеличения батареи
function increaseCharge(amount) {
  charge += amount;
  if(charge > 100) charge = 100;
  fill.style.height = charge + "%";

  if(charge >= 100) {
    answer.classList.add("show");
  }
}

// вращение пальцем (drag)
function getAngle(x, y, centerX, centerY) {
  return Math.atan2(y - centerY, x - centerX) * (180/Math.PI);
}

function startDrag(e) {
  const rect = windmill.getBoundingClientRect();
  const centerX = rect.left + rect.width/2;
  const centerY = rect.top + rect.height/2;

  function onMove(ev) {
    let clientX = ev.touches ? ev.touches[0].clientX : ev.clientX;
    let clientY = ev.touches ? ev.touches[0].clientY : ev.clientY;
    const angle = getAngle(clientX, clientY, centerX, centerY);
    if(lastAngle !== null) {
      let delta = angle - lastAngle;
      rotation += delta;
      blades.style.transform = `rotate(${rotation}deg)`;
      increaseCharge(Math.abs(delta)*0.2); // заряд пропорционален вращению
    }
    lastAngle = angle;
  }

  function endDrag() {
    lastAngle = null;
    window.removeEventListener("mousemove", onMove);
    window.removeEventListener("mouseup", endDrag);
    window.removeEventListener("touchmove", onMove);
    window.removeEventListener("touchend", endDrag);
  }

  window.addEventListener("mousemove", onMove);
  window.addEventListener("mouseup", endDrag);
  window.addEventListener("touchmove", onMove);
  window.addEventListener("touchend", endDrag);

  e.preventDefault();
}

windmill.addEventListener("mousedown", startDrag);
windmill.addEventListener("touchstart", startDrag);
</script>

</body>
</html>
